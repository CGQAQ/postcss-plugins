import n from"postcss-value-parser";var t,e;!function(n){n.Block="block",n.Inline="inline"}(t||(t={})),function(n){n.Start="start",n.End="end"}(e||(e={}));const o={BlockStart:`${t.Block}-${e.Start}`,BlockEnd:`${t.Block}-${e.End}`,InlineStart:`${t.Inline}-${e.Start}`,InlineEnd:`${t.Inline}-${e.End}`};var r,i;function hasKeyframesAtRuleAncestor(n){let t=n.parent;for(;t;)if("atrule"===t.type){if("keyframes"===n.parent.name.toLowerCase())return!0;t=t.parent}else t=t.parent;return!1}function cloneDeclaration(n,t,e){return n.cloneBefore({value:t,prop:e})}function transformSide(n,t){return e=>(cloneDeclaration(e,e.value,`${n}-${t}`),!0)}function transformSideShorthand(t,e){return o=>{const r=n(o.value).nodes.filter((n=>"space"!==n.type));if(r.length>2){const n=`[postcss-logical] Invalid number of values for ${o.prop}. Found ${r.length} values, expected 1 or 2.`;throw new Error(n)}const[i,a]=e;let l,c;return 1===r.length&&(l=r[0].value,c=r[0].value),2===r.length&&(l=r[0].value,c=r[1].value),cloneDeclaration(o,l,`${t}-${i}`),cloneDeclaration(o,c,`${t}-${a}`),!0}}function logicalToPhysical(n,t){const[e,r]=t.block,[i,a]=t.inline;switch(n){case o.BlockStart:return e;case o.BlockEnd:return r;case o.InlineStart:return i;case o.InlineEnd:return a}}function doTransform(t,e,o){const{prop:r,value:i}=t,a=n(i);return a.nodes.forEach((n=>{const t=n.value.toLowerCase();return"word"===n.type&&e.includes(t)&&(n.value=logicalToPhysical(t,o)),n})),a.toString()!==i&&(t.cloneBefore({prop:r,value:a.toString()}),!0)}function transformValueWithSingleDirection(n,e){return r=>{let i=[];return i=n===t.Block?[o.BlockStart,o.BlockEnd]:[o.InlineStart,o.InlineEnd],doTransform(r,i,e)}}function directionFlowToAxes(n){switch(n){case r.TopToBottom:return[i.Top,i.Bottom];case r.BottomToTop:return[i.Bottom,i.Top];case r.RightToLeft:return[i.Right,i.Left];case r.LeftToRight:return[i.Left,i.Right]}}!function(n){n.TopToBottom="top-to-bottom",n.BottomToTop="bottom-to-top",n.RightToLeft="right-to-left",n.LeftToRight="left-to-right"}(r||(r={})),function(n){n.Top="top",n.Right="right",n.Bottom="bottom",n.Left="left"}(i||(i={}));const creator=a=>{const l=Object.assign({preserve:!1,blockDirection:r.TopToBottom,inlineDirection:r.LeftToRight},a),c=Object.values(r);if(!c.includes(l.blockDirection))throw new Error(`[postcss-logical] "blockDirection" must be one of ${c.join(", ")}`);if(!c.includes(l.inlineDirection))throw new Error(`[postcss-logical] "inlineDirection" must be one of ${c.join(", ")}`);const[s,d]=directionFlowToAxes(l.blockDirection),[u,f]=directionFlowToAxes(l.inlineDirection);if(!Object.values(i).every((n=>[s,d,u,f].includes(n))))throw new Error('[postcss-logical] "blockDirection" and "inlineDirection" must be on separate axes');const p={block:[s,d],inline:[u,f],inlineIsHorizontal:[r.LeftToRight,r.RightToLeft].includes(l.inlineDirection)},makeTransform=n=>(t,{result:e})=>{if(!n||hasKeyframesAtRuleAncestor(t))return;const o=t.parent;let r=!1;try{r=n(t)}catch(n){t.warn(e,n.message)}r&&(l.preserve||t.remove(),o.nodes.length||o.remove())};return{postcssPlugin:"postcss-logical",Declaration:{"caption-side":makeTransform((m=p,n=>doTransform(n,Object.values(o),m))),float:makeTransform(p.inlineIsHorizontal?transformValueWithSingleDirection(t.Inline,p):null),clear:makeTransform(p.inlineIsHorizontal?transformValueWithSingleDirection(t.Inline,p):null),"text-align":makeTransform(p.inlineIsHorizontal?(g=p.inline,t=>{const{prop:o,value:r}=t,i=n(r),[a,l]=g;i.nodes.forEach((n=>{const t=n.value.toLowerCase();"word"===n.type&&(t===e.End&&(n.value=l),t===e.Start&&(n.value=a))}));const c=i.toString()!==r;return c&&t.cloneBefore({prop:o,value:i.toString()}),c}):null),"margin-block-start":makeTransform(transformSide("margin",s)),"margin-block-end":makeTransform(transformSide("margin",d)),"margin-inline-start":makeTransform(transformSide("margin",u)),"margin-inline-end":makeTransform(transformSide("margin",f)),"margin-block":makeTransform(transformSideShorthand("margin",[s,d])),"margin-inline":makeTransform(transformSideShorthand("margin",[u,f])),"padding-block-start":makeTransform(transformSide("padding",s)),"padding-block-end":makeTransform(transformSide("padding",d)),"padding-inline-start":makeTransform(transformSide("padding",u)),"padding-inline-end":makeTransform(transformSide("padding",f)),"padding-block":makeTransform(transformSideShorthand("padding",[s,d])),"padding-inline":makeTransform(transformSideShorthand("padding",[u,f]))}};var g,m};creator.postcss=!0;export{creator as default};
